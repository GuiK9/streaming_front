<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Enviar Vídeo</title>
    <script>
        function prepareMetadata(e) {
            e.preventDefault();
            const form = e.target;
            const title = form.title.value;
            const description = form.description.value;
            const metadata = JSON.stringify({ title, description });

            // Cria ou atualiza o campo oculto
            let metaInput = form.querySelector('input[name="metadata"]');
            if (!metaInput) {
                metaInput = document.createElement('input');
                metaInput.type = 'hidden';
                metaInput.name = 'metadata';
                form.appendChild(metaInput);
            }
            metaInput.value = metadata;

            form.submit();
        }
    </script>
</head>
<body>
    <h2>Enviar Vídeo</h2>
    <form action="/upload" method="post" enctype="multipart/form-data" onsubmit="prepareMetadata(event)">
        <label for="title">Título do vídeo:</label>
        <input type="text" id="title" name="title" required><br><br>

        <label for="description">Descrição do vídeo:</label>
        <textarea id="description" name="description" required></textarea><br><br>

        <label for="video">Arquivo de vídeo:</label>
        <input type="file" id="video" name="video" accept="video/*" required><br><br>

        <button type="submit">Enviar</button>
    </form>
</body>
</html>
